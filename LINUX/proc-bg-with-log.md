## 쉘스크립트 백그라운드 실행

쉘스크립트를 백그라운드로 실행하는 명령어를 알아보겠습니다.

---------------------

### 백그라운드 실행 ( `&` 와 `nohup` )

#### `&`  앰퍼샌드(Ampersand)

명령어 뒤에 `&`를 붙이면 프로그램을 백그라운드에서 실행합니다.

```bash
$ sh run_file.sh &
```

하지만 단순히 `&`로 백그라운드 실행을 시키면, 백그라운드로 실행은 되지만 터미널에 계속 출력됩니다.

이때 출력을 무시하는 방법은 다음과 같습니다.

- 출력을 다른 파일로 보내는 방법 `>` (이하 리다이렉션)
  ```bash
  $ sh run_file.bash > ./history.log # 1 생략
  $ sh run_file.bash 1> ./history.log
  $ sh run_file.bash > ./history.log 2>&1 # 표준 출력과 에러를 history.log에서 출력
  ```

표준 입력, 표준 출력 등 파일디스크립터에 대한 내용은 아래 블로그에서 자세하게 설명되어 있습니다. 
  
*(파일디스크립터 등등.. 아직은 받아들이기 어려우니 다음에..)*
  
  > 출처 : [taeho's life logger, 쉘스크립트에서 이따금씩 사용되는 2>&1 이해하기](https://blogger.pe.kr/369)

-------------------------

#### `nohup` 노헙

`nohup`은 리눅스, 유닉스에서 쉘스크립트를 데몬의 형태로 실행하는 POSIX 명령어입니다.

`&`와 마찬가지로 프로그램을 백그라운드로 실행시킬 수 있습니다.

- 실행한 경로상에 nohup.out 파일이 생성 및 표준 출력을 nohup.out로 변경
  ```bash
  $ nohup sh run_file.bash
  ```

단, `nohup`으로 실행할 스크립트는 사용권한 755 이상이어야 합니다.

--------------------------

두 명령어의 차이는 로그아웃하여 세션이 끊어졌을 때 나타납니다.

`&`는 세션이 끊기면 실행되던 프로세스도 종료됩니다. 

*(어떤 경우에는 세션이 끊겨도 종료되지 않는 경우도 있었습니다..?)*

반면에 `nohub`은 세션이 끊겨도 서버에서 백그라운드로 계속 프로그램은 동작합니다.

따라서 대부분의 안전하게 백그라운드로 작동하기 원하시는 분들은 두 명령어를 모두 사용할 수 있습니다.

  ```bash
  $ nohup sh run_file.bash > ./history.log 2>&1 &
  ```
